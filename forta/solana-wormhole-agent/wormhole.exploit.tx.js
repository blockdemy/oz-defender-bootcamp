const { getFindingsFromTx } = require("./src/agent");
const solanaWeb3 = require("@solana/web3.js");

const solanaConnection = new solanaWeb3.Connection(
  "https://api.mainnet-beta.solana.com"
);
const EXPLOIT_TX =
  "2zCz2GgSoSS68eNJENWrYB48dMM1zmH8SZkgYneVDv2G4gRsVfwu5rNXtK5BKFxn7fSqX9BvrBc1rdPAeBEcD6Es";

(async () => {
  const tx = await solanaConnection.getTransaction(EXPLOIT_TX);
  console.log(getFindingsFromTx(tx));
})();
